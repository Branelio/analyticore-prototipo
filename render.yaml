# Archivo de configuración de Render Blueprint

services:
  # Servicio de Base de Datos PostgreSQL
  - type: pserv
    name: analyticore-db
    plan: free
    region: oregon
    
  # Servicio de Submisión (Python)
  - type: web
    name: analyticore-python
    # IMPORTANTE: Eliminamos 'env: python' para que Render use Docker
    region: oregon
    plan: free
    dockerContext: ./python-service
    dockerCommand: uvicorn main:app --host 0.0.0.0 --port 8000
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: analyticore-db
          property: connectionString
      - key: JAVA_SERVICE_URL
        fromService:
          name: analyticore-java
          property: httpsUri

  # Servicio de Análisis (Java)
  - type: web
    name: analyticore-java
    # IMPORTANTE: Eliminamos 'env: java' para que Render use Docker
    region: oregon
    plan: free
    dockerContext: ./java-service
    dockerCommand: java -jar app.jar
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: analyticore-db
          property: connectionString

  # Frontend (React con Nginx)
  - type: web
    name: analyticore-frontend
    # IMPORTANTE: Eliminamos 'env: static' para que Render use Docker
    region: oregon
    plan: free
    dockerContext: ./frontend
    dockerCommand: nginx -g "daemon off;"
    envVars:
      - key: REACT_APP_API_BASE_URL
        fromService:
          name: analyticore-python
          property: httpsUri